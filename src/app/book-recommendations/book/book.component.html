<article [ngStyle]="{
  '--book-index': bookIndex(),
  '--book-backface-color': bookDetails().backfaceColor,
  '--book-page-padding': '1rem'
}">
  <ul>
    <li
      [ngClass]="{'before:shadow-[inset_0_0_0_transparent]!': isBookCoverOpen()}"
      class="
        group/item relative inline-block text-dark-void
        before:absolute before:top-0 before:left-0.5 before:z-31 before:block
        before:h-full before:w-0.5 before:bg-transparent
        before:shadow-[inset_0_0_1px_--theme(--color-dark-void-dark/0.7)]
        before:transition-all before:duration-500 before:ease-[ease]
      ">
      <img
        [ngSrc]="bookDetails().cover.imagePath" [width]="bookWidth()" [height]="bookDetails().cover.height"
        disableOptimizedSrcset
        [loaderParams]="{imageFormat: 'webp'}" priority
        [ngClass]="{'transform-[perspective(1500px)_rotateY(-150deg)]! shadow-[3px_1px_7px_--theme(--color-dark-void-dark/0.5)]!': isBookCoverOpen()}"
        class="
          relative z-[calc(21+var(--book-index))] origin-[0_70%] cursor-pointer
          rounded-[2px_3px_3px_2px] opacity-100
          shadow-[1px_1px_4px_--theme(--color-dark-void-dark/0.5)]
          transition-all duration-500 ease-[ease] backface-hidden
          group-hover/item:transform-[perspective(1500px)_rotateY(-22deg)]
          group-hover/item:shadow-[3px_1px_7px_--theme(--color-dark-void-dark/0.5)]
        "
        [alt]="bookDetails().details.title + ': ' + bookDetails().details.subtitle"
        (click)="toggleCoverOpen()" (keyup)="toggleCoverOpen()" tabindex="0"/>
      <div [ngClass]="{'ml-px! transform-[perspective(1500px)_rotateY(-300deg)]! sm:transform-[perspective(1500px)_rotateY(-330deg)]!': isBookCoverOpen()}"
           class="
             absolute top-0 -left-full z-[calc(20+var(--book-index))] size-full
             origin-[100%_70%] transform-[perspective(1500px)_rotateY(-180deg)]
             cursor-pointer rounded-[3px_0_0_3px] border-[3px] border-r-0
             border-solid border-(--book-backface-color) bg-snow
             shadow-[-10px_0_10px_--theme(--color-dark-void-dark/0.2),inset_40px_0_60px_--theme(--color-dark-void-dark/0.15),0_0_0_1px_--theme(--color-snow/0.15)]
             transition-all duration-500 ease-[ease] backface-hidden
             group-hover/item:transform-[perspective(1500px)_rotateY(-202deg)]
           "
           (click)="toggleCoverOpen()" (keyup)="toggleCoverOpen()" tabindex="0">
        <div class="
          flex h-full items-center justify-center overflow-hidden
          p-[calc(2*var(--book-page-padding))] text-center
          sm:p-(--book-page-padding)
        ">
          <div class="book-cover">
            <a [href]="bookDetails().url" target="_blank" (click)="$event.stopPropagation()">Zum Buch von {{ bookDetails().details.author }}</a>
          </div>
        </div>
      </div>
      <div class="absolute top-0 left-0 z-10 size-full p-px">
        <ul class="
          absolute top-0 left-0 z-0 ml-px size-full
          *:absolute *:size-full *:rounded-[2px_3px_3px_2px] *:border
          *:border-l-0 *:border-solid *:border-snow *:bg-snow
          *:shadow-[1px_1px_1px_1px_--theme(--color-dark-void-dark/0.2)]
          after:absolute after:-bottom-2.25 after:-left-0.5 after:z-0
          after:block after:size-0 after:border-[5px] after:border-solid
          after:border-t-(--book-backface-color)
          after:border-r-(--book-backface-color) after:border-b-transparent
          after:border-l-transparent
        ">
          <li class="
            top-0 left-0 z-5 overflow-hidden p-(--book-page-padding)
            shadow-[1px_1px_1px_1px_--theme(--color-dark-void-dark/0.2),inset_7px_0_10px_-5px_--theme(--color-dark-void-dark/0.15),inset_0_0_60px_--theme(--color-dark-void-dark/0.1)]!
          ">
            <div class="*:leading-none">
              <h3 class="text-center text-lg">{{ bookDetails().details.title }}</h3>
              <h4 class="text-center text-sm">{{ bookDetails().details.subtitle }}</h4>
              <div class="mx-auto my-3 divider max-w-[50%]"></div>
              <p class="text-sm">{{ bookDetails().details.summary }}</p>
            </div>
            <span class="absolute right-0 bottom-0 me-2 mb-2 text-xs">1</span>
          </li>
          <li class="top-0.5 left-0.5 z-4"></li>
          <li class="top-1 left-1 z-3"></li>
          <li class="top-1.5 left-1.5 z-2"></li>
        </ul>
      </div>
      <div class="
        absolute top-2 left-2.25 z-1 size-full rounded-[2px_3px_3px_2px]
        bg-(--book-backface-color)
      "></div>
    </li>
  </ul>
</article>
